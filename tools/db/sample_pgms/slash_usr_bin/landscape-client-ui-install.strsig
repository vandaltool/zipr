    action = policykit1.PK_ACTION_INSTALL_OR_REMOVE_PACKAGES
              "administrators manage multiple machines efficiently."), link,
    aptclient = AptClient()
        "<big><b>%s</b></big>\n\n%s\n\n%s\n\n%s" % (
    bindtextdomain("landscape-client", "/usr/share/locale")
    bus = dbus.SystemBus()
    button = dialog.add_button(_("Install"), Gtk.ResponseType.YES)
    button.grab_focus()
        buttons=Gtk.ButtonsType.CANCEL)
def install_package():
def main():
def on_transaction_done(transaction, exit):
    dialog = AptProgressDialog(transaction)
    dialog.destroy()
    dialog = Gtk.MessageDialog(
    dialog.run(close_on_finished=True, show_error=True)
    dialog.set_markup(
    dialog.set_title(_("Install Landscape client?"))
              "Do you want to install it now?")))
    else:
    except NotAuthorizedError:
        flags=Gtk.DialogFlags.MODAL, type=Gtk.MessageType.INFO,
    flags = policykit1.CHECK_AUTH_ALLOW_USER_INTERACTION
from aptdaemon.client import AptClient
from aptdaemon.errors import NotAuthorizedError
from aptdaemon.gtk3widgets import AptProgressDialog
from aptdaemon import policykit1
from defer import inline_callbacks
from gettext import gettext as _, bindtextdomain, textdomain
from gi.repository import GObject, Gtk
        GObject.idle_add(main)
        Gtk.main()
        Gtk.main_quit()
    Gtk.main_quit()
if __name__ == "__main__":
    if not os.path.exists(script):
    if os.path.exists(script):
    if result == Gtk.ResponseType.YES:
import dbus
import os
import sys
@inline_callbacks
    # Install may have failed
        install_package()
            _("Landscape client"),
            _("Landscape is an easy-to-use commercial systems management and "
    link = "<a href=\"https://landscape.canonical.com\">%s</a>" % _("Find out more...")
              "monitoring service offered by Canonical that helps "
    name = bus.get_unique_name()
        os.execl(sys.executable, sys.executable, script)
    result = dialog.run()
    return False
script = "/usr/bin/landscape-client-settings-ui"
    textdomain("landscape-client")
    transaction.connect("finished", on_transaction_done)
    transaction = yield aptclient.install_packages(["landscape-client-ui"])
    try:
#!/usr/bin/python
        yield policykit1.check_authorization_by_name(name, action, flags=flags)
            _("You need to install Landscape client to be able to configure it. "
