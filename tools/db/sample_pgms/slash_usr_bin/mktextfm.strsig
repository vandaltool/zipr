) 1>&2 </dev/null
#!/bin/sh
    *) break ;;
  case "$1" in
case "$MT_FEATURES" in
  cat $$.badpos $$.strange $$.angle | sort > $$.errs_accept
  cd "$PKDESTDIR" || exit 1
cd $TEMPDIR
cd "$TFMDESTDIR" || exit 1
# Check if this font is supported by hbf2gf else use metafont.
    chmod `kpsestat -xst,go-w .` pk$$.tmp
chmod `kpsestat -xst,go-w .` tfm$$.tmp
$cmd </dev/null || {
  cmd="hbf2gf -g $NAME $DPI"
  cmd="$MF \mode:=$MODE; mag:=$MAG; nonstopmode; input $NAME"
# Common code for all scripts.
    || cp $PKNAME "$PKDESTDIR/pk$$.tmp" || exit 1
  || cp $TFMNAME "$TFMDESTDIR/tfm$$.tmp" || exit 1
#DEST="$2"
    --destdir=*) DEST=`echo "$1" | sed 's/--destdir=//'`; shift ;;
    --destdir) shift; DEST="$1"; shift ;;
  # determine the progname of metafont to use; prefer mf-nowin.
  # Don't abort if only "Strange path", "bad pos" or "angle(0,0)"
DPI=$BDPI
  echo "$progname: Cannot find mktex.opt; check your installation." >&2
    echo "$progname: \`$cmd' failed." >&2
  echo "$progname: mktexdir $TFMDESTDIR failed."
echo "$progname: Running $cmd"
  echo "$progname: $TFMDESTDIR/$TFMNAME already exists." >&2
echo "$progname: $TFMDESTDIR/$TFMNAME: successfully generated." >&2
      && echo "$progname: warning: \`$cmd' caused angle(0,0) errors." >&2
      && echo "$progname: warning: \`$cmd' caused bad pos errors." >&2
      && echo "$progname: warning: \`$cmd' caused strange path errors." >&2
  echo "$TFMDESTDIR/$TFMNAME" >$STDOUT
echo "$TFMDESTDIR/$TFMNAME" >$STDOUT
  # errors occurr.
    exit 1;
  exit 1
     export MT_MFDESTDIR;;
GFNAME=$NAME.$DPI'gf'
  gftopk ./$GFNAME $PKNAME || exit 1
  grep '^! angle(0,0) is taken as zero.' $$.errs >$$.angle 2>/dev/null
  grep '^! bad pos.' $$.errs >$$.badpos 2>/dev/null
  grep '^!' $NAME.log | sort >$$.errs 2>/dev/null
  grep '^! Strange path' $$.errs >$$.strange 2>/dev/null
# Handle non-positional options, except for --version/--help
# hbf2gf just produces a .pl file:
    --help|-help) break ;;
  if cmp $$.errs $$.errs_accept >/dev/null 2>&1; then
if (hbf2gf -q -t $NAME) >/dev/null 2>&1; then
  if (mf-nowin --version) >/dev/null 2>&1; then
IFS=$OIFS
if test ! -d "$TFMDESTDIR"; then
if test ! -f "$MT_MKTEX_OPT"; then
  if test -f $PKNAME; then
if test -r $GFNAME && test ! -f "$PKDESTDIR/$PKNAME"; then
if test -r "$TFMDESTDIR/$TFMNAME"; then
# (If you change or delete the word `original' on the previous line,
# installation won't write this script over yours.)
# Install the TFM file carefully, since others may be working simultaneously.
# it's needed.
MAG=1  # mag=0 fails with larm1000.mf
Makes a TFM file for FONT, if possible. Use DESTDIR for the root of where
    MF=mf
    MF="mf-nowin -progname=mf"
     : ${MT_MFDESTDIR=`pwd`}
  "$MT_MKTEXDIR" "$PKDESTDIR"
"$MT_MKTEXDIR" "$TFMDESTDIR"
. "$MT_MKTEX_OPT"
: ${MT_MKTEX_OPT=`kpsewhich --format='web2c files' mktex.opt`}
    "$MT_MKTEXUPD" "$PKDESTDIR" $PKNAME
  "$MT_MKTEXUPD" "$TFMDESTDIR" $TFMNAME
"$MT_MKTEXUPD" "$TFMDESTDIR" $TFMNAME
: ${MT_TEXMFMAIN=`kpsewhich --expand-path='$TEXMFMAIN'`}
  mv $PKNAME "$PKDESTDIR/pk$$.tmp" 2>/dev/null \
    mv pk$$.tmp $PKNAME
mv $TFMNAME "$TFMDESTDIR/tfm$$.tmp" 2>/dev/null \
NAME=`basename "$1" .tfm`
  *nomfdrivers*)
OIFS=$IFS; IFS=$SEP
# OK, success with the TFM.
# original mktextfm -- make a new TFM file, because one wasn't found.
PKDEST="$1"
PKDESTDIR=`echo "$PKDEST" | sed 's%/[^/][^/]*$%%'` # can't rely on dirname
PKNAME=`basename "$PKDEST"`
progname=`echo $0 | sed 's%.*/%%'`
# Public domain.
    rm -f pk$$.tmp
set x `"$MT_MKTEXNAM" $NAME $DPI $MODE $DEST`; shift
# Since we probably made a GF(->PK) file, too, may as well install it if
# start of redirection stdout -> stderr, stdin <- /dev/null
# te@dbs.uni-hannover.de, kb@mail.tug.org, and infovore@xs4all.nl.
test -n "$MT_MKTEX_OPT" || MT_MKTEX_OPT="$MT_TEXMFMAIN/web2c/mktex.opt"
test -r ./$NAME.pl && pltotf ./$NAME.pl $TFMNAME
test -r $TFMNAME || { echo "$progname: \`$cmd' failed to make $TFMNAME."; exit 1; }
test -r $TFMNAME || mv tfm$$.tmp $TFMNAME || exit 1
    test -s $$.angle >/dev/null 2>&1 \
    test -s $$.badpos >/dev/null 2>&1 \
    test -s $NAME.log && mv -f $NAME.log "$KPSE_DOT"
    test -s $$.strange >/dev/null 2>&1 \
TFMDEST="$2"
TFMDESTDIR=`echo "$TFMDEST" | sed 's%/[^/][^/]*$%%'`
TFMNAME=$NAME.tfm
to install into, either the absolute directory name to use (if it starts
# Try to create the destdir first. Do not create fonts, if this fails.
usage="Usage: $progname [--destdir DESTDIR] FONT.
# Use cp when mv fails, since DOS will fail mv for deeply-nested directories.
version='$Id: mktextfm,v 1.27 2004/07/03 19:25:15 olaf Exp $'
    --version|-version) break ;;
# Where do potential mf driver files go?
while test $# -gt 0; do
with a /) or relative to the default DESTDIR (if not)."
