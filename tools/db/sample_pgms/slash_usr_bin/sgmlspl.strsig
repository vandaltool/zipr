      };
########################################################################
# Added debian changes for version 1.03ii-27.
# Added $SGMLS_PL::version variable and changed SDATA notation from
# Added some missing 'last SWITCH;' statements in the sgmls function.
# along with this program; if not, write to the Free Software
# applied patch for 414110 & upgraded policy
$ARGV = shift;
# (at your option) any later version.
# be an argument to it.
# but WITHOUT ANY WARRANTY; without even the implied warranty of
				# cdata handler
	  &{$cdata_handler}($event->data,$event);
	  $cdata_handler = $handler;
$cdata_handler = sub { main::output($_[0]); };
#   'cdata'                 Regular character data.
# Changed 'print' to 'main::output' for re handler; empty string
# Changed "use Output" to "use SGMLS::Output".  Qualified the STDIN
				# conforming handler
	  &{$conforming_handler}($event->data,$event);
	  $conforming_handler = $handler;
$conforming_handler = sub {};
#   'conforming'            The document is conforming.
# Copyright (c) 1995 by David Megginson <dmeggins@aix1.uottawa.ca>
      die "Bad SGML handler pattern: $spec\n";
	die "FATAL: $ARGV does not exist.\n";
	die "FATAL: $ARGV exists but is read-protected.\n";
	die "FATAL: $@\n";
      die "Unknown SGML event type: $type\n";
# Do the actual work, using the SGMLS package.
# Eliminated all use of the SGMLS_Event::key method.
	} else {
    } elsif ($@) {
    } elsif (!-r $ARGV) {
# *** empty log message ***
# empty scripts or scripts which do not end with '1;'; pass the event
#   '&ENAME;'               A reference to the external entity ENAME.
#   '{ENAME}'               The beginning of the subdocument-entity ENAME.
#   '{/ENAME}'              The end of the subdocument-entity ENAME.
				# end-document handler
	  $end_document_handler = $handler;
&{$end_document_handler}();	# run the end handler
$end_document_handler = sub {};
				# end-element handler
	  $end_element_handlers->{$1} = $handler;
	  &{($end_element_handlers->{$event->data->name}||
	  $end_element_handlers->{''} = $handler;
$end_element_handlers = { '' => sub {} };
		$end_element_handlers->{''} || sub {})}($event->data,$event);
#   'end_element'           The end of an element.
				# end-subdoc handler
	  $end_subdoc_handlers->{$1} = $handler;
	  &{($end_subdoc_handlers->{$event->data->name}||
	  $end_subdoc_handlers->{''} = $handler;
$end_subdoc_handlers = { '' => sub {} };
	     $end_subdoc_handlers->{''} || sub {})}($event->data,$event);
#   'end_subdoc'            The end of a subdocument entity.
#   'end'                   The end of the document.
#   'entity'                An external-entity reference.
	  $entity_handlers->{$1} = $handler;
	  &{($entity_handlers->{$event->data->name}||
	  $entity_handlers->{''} = $handler;
$entity_handlers = { '' => sub {} };
	     $entity_handlers->{''} || sub {})}($event->data,$event);
				# entity-reference handler
eval 'exec /usr/bin/perl  -S $0 ${1+"$@"}'
				# event
# event occurs (this is usually useful only for the specific, named
# events), or a reference to an anonymous subroutine, which will
# example,
# filehandle for the SGMLS object with the main:: package name.
# for certain specific, named events, as follow:
# Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
				# generic end-element handler
				# generic end-subdoc handler
				# generic entity-reference handler
				# generic sdata handler
				# generic start-element handler
				# generic start-subdoc handler
#   '<GI>'                  The beginning of element GI.
#   '</GI>'                 The end of element GI.
# GNU General Public License for more details.
	    $handler = eval "sub { main::output('$handler'); };";
	$handler =~ s/'/\\'/g;
	$handler =~ s/\\/\\\\/g;
	    $handler = sub {};
    if 0; # not running under some shell
    if (!-e $ARGV) {
	if ($handler eq '') {
    if (ref($handler) ne 'CODE') {
# In addition to these generic events, it is possible to handlers
# Initial revision
# itself as the second argument to each handler, after the event data.
# it under the terms of the GNU General Public License as published by
	  last SWITCH;
# $Log: sgmlspl,v $
# Main access point: declare handlers for different SGML events.
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    my ($spec,$handler) = (@_);
    my $type = $event->type;
# only the first as a perl script and the rest as its arguments; allow
package main;
package SGMLS_PL;
$parse = new SGMLS(main::STDIN);	# a new parse object
#          parsers (requires SGMLS.pm library).
#   'pi'                    A processing instruction.
	  &{$pi_handler}($event->data,$event);
	  $pi_handler = $handler;
$pi_handler = sub { '' => sub {} };
				# processing-instruction handler
# read here and evaluated in the 'main' package -- everything else will
#   're'                    A record-end.
# receive two arguments: the event data and the event itself.  For 
				# record-end handler
	  &{$re_handler}($event->data,$event);
	  $re_handler = $handler;
$re_handler = sub { main::output("\n"); };
# Revised version for 1.01 distribution.
# Revision 1.1  1995/04/22  14:40:50  david
# Revision 1.1  2001/04/15 14:42:01  ardo
# Revision 1.1  2004/02/23 01:23:07  ardo
# Revision 1.2  1995/04/22  20:58:48  david
# Revision 1.2  2008-01-03 23:49:25  ardo
# Revision 1.3  1995/04/22  21:02:49  david
# Revision 1.4  1995/04/23  14:44:58  david
# Revision 1.5  1995/04/27  11:52:25  david
# Revision 1.6  1995/08/12  16:15:14  david
# Revision 1.7  1995/11/15  20:22:24  david
# Revision 1.8  1995/12/03  21:46:31  david
				# run the appropriate handler for each
				# sdata handler
	  $sdata_handlers->{$1} = $handler;
	  &{($sdata_handlers->{$event->data}||
	  $sdata_handlers->{''} = $handler;
	     $sdata_handlers->{''} || sub {})}($event->data,$event);
$sdata_handlers = { '' => sub { main::output($_[0]);} };
#   'sdata'                 Special system-specific data.
#   '[SDATA]'               The system-specific data SDATA.
# [SDATA] to |SDATA|.
# Set up handler defaults.
#   sgml('<FOO>', "\n\\begin{foo}\n");
#   sgml('<FOO>', sub { output("\n\\begin{foo}\n"); });
# sgmlspl: a simple SGML postprocesser for the SGMLS and NSGMLS
      $spec =~ /^<([^\/].*|)>$/ && do {
      $spec =~ /^<\/(.*)>$/ && do {
      $spec =~ /^\|(.*)\|$/ && do {
      $spec =~ /^\{([^\/].*|)\}$/ && do {
      $spec =~ /^\{\/(.*)\}$/ && do {
      $spec =~ /^\&(.*);$/ && do {
      $spec =~ 'end_element' && do {
      $spec eq 'cdata' && do {
      $spec eq 'conforming' && do {
      $spec eq 'end' && do {
      $spec eq 'end_subdoc' && do {
      $spec eq 'entity' && do {
      $spec eq 'pi' && do {
      $spec eq 're' && do {
      $spec eq 'sdata' && do {
      $spec eq 'start' && do {
      $spec eq 'start_element' && do {
      $spec eq 'start_subdoc' && do {
				# start-document handler
	  $start_document_handler = $handler;
&{$start_document_handler}();	# run the start handler.
$start_document_handler = sub {};
				# start-element handler
	  $start_element_handlers->{$1} = $handler;
	  &{($start_element_handlers->{$event->data->name}||
	  $start_element_handlers->{''} = $handler;
$start_element_handlers = { '' => sub {} };
		$start_element_handlers->{''} || sub {})}($event->data,$event);
#   'start_element'         The beginning of an element.
				# start-subdoc handler
	  $start_subdoc_handlers->{$1} = $handler;
	  &{($start_subdoc_handlers->{$event->data->name}||
	  $start_subdoc_handlers->{''} = $handler;
$start_subdoc_handlers = { '' => sub {} };
	     $start_subdoc_handlers->{''} || sub {})}($event->data,$event);
#   'start_subdoc'          The beginning of a subdocument entity.
#   'start'                 The beginning of the document.
# string; instead of evaluating every argument as a perl script, take
sub main::sgml {
  SWITCH: {
# The event may be one of the following strings, or a special pattern.
# The first argument on the command line is a perl module which will be
# the Free Software Foundation; either version 2 of the License, or
# The generic events are as follow:
# The handler may be a string, which will simply be printed when the
# This program is distributed in the hope that it will be useful,
# This program is free software; you can redistribute it and/or modify
# translates into an empty sub {} rather than a sub printing an empty
      $type eq 'cdata' && do {
      $type eq 'conforming' && do {
      $type eq 'end_element' && do {
      $type eq 'end_subdoc' && do {
      $type eq 'entity' && do {
      $type eq 'pi' && do {
      $type eq 're' && do {
      $type eq 'sdata' && do {
      $type eq 'start_element' && do {
      $type eq 'start_subdoc' && do {
unless ($ARGV eq '' || do 'sgmlspl-specs/' . $ARGV || do $ARGV) {
# Usage: sgml(event, handler);
use SGMLS;
use SGMLS::Output;
# Use the Output package.  Fixed the $version variable.
#!/usr/bin/perl
$version = '$Id: sgmlspl,v 1.2 2008-01-03 23:49:25 ardo Exp $';
while ($event = $parse->next_event) {
# will have identical results.
# You should have received a copy of the GNU General Public License
