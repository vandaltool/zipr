	    }  
#  Added a check on the return status of open("> Makefile").
#    along with this program.  If not, see <http://www.gnu.org/licenses/>.
    are exported as eps format. (this is the default)
#    (at your option) any later version.
  $base = $fig;
@base_names = ();
  $base =~ s/\.fig$//;
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
by LaTeX.
#  Changed hashbang to use the '/usr/bin/env perl' hack for portability
close(MAKEFILE);
#    Copyright 2009 Joseph E. Fields
create .tex files which are \input into your latex file to include the 
current director for .fig files and use fig2dev (pstex and pstex_t) to 
 -d DIR Directory containing the figures (a path relative to
#default values of a few variables
	    die;
		die("Bad arg for -m (magnification factor): $mag_factor\n\n");
} else {
	else { 
	elsif (/^-d$/) { 
	elsif (/^-h$/ || /^--help$/) { 
	elsif (/^-l$/) { 
	elsif (/^-p$/) { 
	elsif (/^--version$/) {
#    email: fieldsj1@southernct.edu
    $ext = ".eps";
    $ext = ".pdf";
@fig_files = grep(/\.fig$/, readdir(THISDIR));
$figure_directory = "./";
	    $figure_directory = shift @ARGV;
#First we run through the list of .fig files to make a list of corresponding
foreach $fig (@fig_files) {
#For each .fig file we need to add appropriate lines to the Makefile
foreach $nm (@base_names) {
    get converted to pdf format. 
#    GNU General Public License for more details.
graphic.  Any text in the figure with the 'special' flag set is processed
 -h Help -- print this message and quit.
	    if (! (-d "../".$figure_directory)) {
	    if ($figure_directory eq "") {
if ($figure_directory =~ m/\/$/) {
	if (/^-m$/) { 
	    if ( ! ($mag_factor > 0.0)  ) { 
if ($pdflatex == 1){
#    it under the terms of the GNU General Public License as published by
 -l Latex -- create makefile for use with (regular) latex -- the images
#Look for files ending with the .fig extension in the current directory.
$mag_factor = 1.0;
	    $mag_factor = shift @ARGV; 
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 -m NUM Magnification factor.
MULTILINE
opendir(THISDIR, ".");
open(MAKEFILE, "> Makefile") || die "Can't open Makefile for write. \n"; ;
#  Original release.
&parse_command_line;
$pdflatex = 0;
	    $pdflatex = 0; 
	    $pdflatex = 1; 
 -p Pdflatex -- create makefile for use with pdflatex -- the images
  $pref = $figure_directory . "/";
  $pref = $figure_directory;
		print "containing the figures, which you should currently be in!\n\n";
print "If you are changing from PdfLaTeX (-p) to LaTeX (-l), or vice versa, \n";
		print " LaTeX source files). \n\n";
print MAKEFILE "all: @tex_files\n\n";
  print MAKEFILE "clean::\n";
print MAKEFILE "\#\n\# fig4latex makefile\n\#\n\n";
  print MAKEFILE "$nm\.eps: $nm\.fig \n";
  print MAKEFILE "$nm\.pdf: $nm\.eps \n";
  print MAKEFILE "$nm\.tex: $nm$ext \n";
  print MAKEFILE "\tepstopdf $nm\.eps\n\n";
  print MAKEFILE "\tfig2dev -L pstex -m $mag_factor $nm\.fig > $nm\.eps\n\n";
  print MAKEFILE "\tfig2dev -L pstex_t -p $pref$nm$ext -m $mag_factor $nm\.fig > $nm\.tex\n\n";
  print MAKEFILE "\# translation into pstex\n\n";
  print MAKEFILE "\trm -f $nm\.tex $nm\.eps $nm\.pdf\n\n\n";
  print <<"MULTILINE";
		print "\nArgument after -d must be the name of the directory\n";
print "\nNow run \'make\' to update your graphics files.\n\n";
		print "\nPlease specify a path to the figures (relative to the\n";
		print "\nThe next thing after the -m option is supposed to be a number\n";       
	    print "\nThis is Fig4latex, version $version.\n\n";
print "run \'make clean\' then \'make\'.\n\n";
  push(@base_names, $base);
  push(@tex_files, $tex_file_name);
	$_ = shift @ARGV;               # in a subroutine 
sub parse_command_line{ 
sub usage{ 
  $tex_file_name = $fig;
  $tex_file_name =~ s/\.fig$/\.tex/;
@tex_files = ();
#.tex files these are used as the dependencies for the "all" target.
        the directory where your LaTeX source files are).
#    the Free Software Foundation, either version 3 of the License, or
This program creates a Makefile.  Running 'make' will then search the
#    This program is distributed in the hope that it will be useful,
#    This program is free software: you can redistribute it and/or modify
	    &usage && die; 
Usage: fig4latex [-d dir] [-m NUM] [-p] [-l] [-h] 
#!/usr/bin/env perl
# Version 0.1
$version = "0.2";
# Version 0.2
    while ($ARGV[0] =~ /^-/) {
#    You should have received a copy of the GNU General Public License
