## ----------------------------------------------------------------------
$0  =~ m|[^/]+$|;
		  'add=s'       => \$add,
                    as target for 'add'/'remove' or as sources for 'update'
        chmod 0644, $tmpfile or die("chmod $tmpfile: $!");
	closedir( PARSER_DETAILS_DIR );
    close( $handle );
	    close( PARSER_DETAILS );
## Copyright (C) 2001-2003 Ardo van Rangelrooij
## Copyright (C) 2007      Niko Tyni
## Debian update-perl-sax-parsers version 0.3
                    (default = '/etc/perl/XML/SAX/ParserDetails.ini')
# default priority is 50 unless --directory was specified
                    (default = '/var/lib/libxml-sax-perl/ParserDetails.d')
	    || die "Cannot access $directory: $!";
		|| die "Cannot read from $parser_details: $!";
	        || die "Cannot write to $file: $!";
    --directory     Perl SAX parser module info file directory to be used
		  'directory=s' => \@directory,
    } else {
elsif ( $remove )
elsif ( $update )
    exit 0;
    exit 1;
$file = $PARSER_DETAILS_FILE if ! $file;
    --file          Perl SAX parser module info file to be updated
		  'file=s'      => \$file,
    foreach my $directory ( @directory)
	for my $parser_details ( @files )
        ($handle, $tmpfile) = tempfile();
    --help          display this help text (usage)
		  'help'        => \$help,
                    highest priority is the default parser.
if ( $add )
if ( ! GetOptions(
if ( $help )
    if $test && ! $quiet;
    if ($ucf) {
if ( $version )
my $add       = '';
my @directory = ();
my $file      = '';
	my @files = sort readdir ( PARSER_DETAILS_DIR );
    my ($handle, $tmpfile);
my $help      = '';
my $name = $&;
my $PARSER_DETAILS_DIR  = "/var/lib/libxml-sax-perl/ParserDetails.d";
my $PARSER_DETAILS_FILE = "/etc/perl/XML/SAX/ParserDetails.ini";
    my $parser_file = $remove;
my $priority;
my $quiet     = '';
my $remove    = '';
my $test      = '';
my $ucf;
my $update    = '';
my $version   = '';
    $name <options> --add <parser_module>
    $name <options> --remove <parser_module>
    $name <options> --update
	    next if $parser_details =~ /^\.\.?$/; # skip . and ..
                    of ucf with '--update'.
	opendir( PARSER_DETAILS_DIR, $directory )
        open( $handle, ">$file" )
	    open( PARSER_DETAILS, "$directory/$parser_details" )
Options:
## or later for copying conditions.  There is NO warranty.
    $parser_file = File::Spec->catfile( $directory[0], $parser_file );
    $parser_file = "${priority}-$parser_file" if $priority != 0;
    print "Debian $name version 0.4\n";
    print "$name: Registering Perl SAX parser $add with priority $priority...\n"
    print "$name: Unregistering Perl SAX parser $remove with priority $priority...\n"
    print "$name: Updating overall Perl SAX parser modules info file...\n"
    print STDERR <<END;
    print STDERR "$name: Automatic registration of SAX parsers might not work.\n";
    print STDERR "$name: Non-vendor version of XML::SAX is installed.\n";
print STDERR "$name: test mode - Perl SAX parsers file will not be updated\n"
$priority = (@directory ? 0 : 50) if not defined $priority;
		  'priority=i'  => \$priority,
    --priority      The priority of the parser to add. The parser with the
push( @directory, $PARSER_DETAILS_DIR) if ! @directory;
    --quiet         be quiet
		  'quiet'       => \$quiet,
		  'remove=s'    => \$remove,
sub usage
sub version
        system("ucf --debconf-ok --sum-file /var/lib/libxml-sax-perl/ParserDetails.ini.md5sum $tmpfile $file");
    --test          do not modify any files, enable debugging mode
		  'test'        => \$test,
## This is free software; see the GNU General Public Licence version 2
$ucf  = ($file ? 0 : 1) if not defined $ucf;
		  'ucf=i'       => \$ucf,
    --ucf X         Forcibly disable (X == 0) or enable (X != 0) the use
        unless $quiet;
unless (XML::SAX->can("_is_vendor_supplied")) {
    unlink( $parser_file );
        unlink $tmpfile or die("unlink $tmpfile: $!");
		  'update'      => \$update,
    &usage;
use File::Spec;
use File::Temp qw(tempfile);
use Getopt::Long;
use strict;
# use ucf by default if --file is not specified
use XML::SAX;
use XML::SAX::Debian;
#!/usr/bin/perl
    &version;
    --version       display version number
		  'version'     => \$version,
	    while ( <PARSER_DETAILS> ) { print $handle $_; }
# with --directory, default to 0 (no priority in the filenames)
    XML::SAX::Debian->save_parsers_debian( $add, $directory[0], $priority );
